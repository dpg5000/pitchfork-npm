#Pitchfork Client

An unofficial Node.js client for [Pitchfork](http://pitchfork.com/) reviews based on the [Pitchfork API Client for Python](https://github.com/michalczaplinski/pitchfork).

## Install

### Using NPM
```bash
npm install pitchfork
```
### Using Github
```bash
git clone git@github.com:omardelarosa/pitchfork-npm.git
```
You can then use it as a [command-line tool](#cli-command-line-interface) or as a [node module](#api)

##API

You can require ``pitchfork`` and use it inside of any Node.JS application.

```javascript
var p4k = require('pitchfork')
```

### Search

A {Search} constructor that extends [EventEmitter](http://nodejs.org/api/events.html#events_class_events_eventemitter).  Listeners can be attached to the 'ready' event which will fire when all reviews have been fetched and parsed.  For example:

```javascript

var p = require('pitchfork')
var s = new p.Search('wilco')

s.on('ready', function(results){
  console.log("results", results)
})

//=> [ {Review}, {Review}, {Review}, ... ]
```

``.results``

An {Array} of {Review} objects.

``.init``

Called once when Search is instantiated to fetch results.  Not usually called directly

### Review

The {Review} constructor encapsulates methods and data relating to the Pitchfork review.  The {Review} extends {EventEmitter} and fires a 'ready' event when the review has been fetched and parsed.


``.attributes``

An {Object} with information about the album and its text.  Sample below:

```json
{
  "url": "/reviews/albums/9419-the-letting-go/",
  "name": "Bonnie \"Prince\" Billy - The Letting Go",
  "artist": "Bonnie \"Prince\" Billy",
  "album": "The Letting Go",
  "title": "Bonnie \"Prince\" Billy: The Letting Go | Album Reviews | Pitchfork",
  "label": "Palace / Drag City",
  "year": "2006",
  "score": 8.2,
  "cover": "http://cdn.pitchfork.com/albums/9255/homepage_large.e8a2bd20.jpg",
  "author": "Mark Richardson",
  "date": "September 18, 2006",
  "editorial": {
    "text": "...",
    "html": "..."
}
```

``.fetch``

This method is automatically called when the {Review} is instantiated and returns a [Promise](https://github.com/kriskowal/q).  This generally isn't called directly.

``.promise``

This stores the thennable promise object generated by .fetch for attaching .then-style callbacks.


``.verbose``

The full {Review} instance represented as JSON.

```json
{
  "url": "/reviews/albums/9419-the-letting-go/",
  "name": "Bonnie \"Prince\" Billy - The Letting Go",
  "artist": "Bonnie \"Prince\" Billy",
  "album": "The Letting Go",
  "title": "Bonnie \"Prince\" Billy: The Letting Go | Album Reviews | Pitchfork",
  "label": "Palace / Drag City",
  "year": "2006",
  "score": 8.2,
  "cover": "http://cdn.pitchfork.com/albums/9255/homepage_large.e8a2bd20.jpg",
  "author": "Mark Richardson",
  "date": "September 18, 2006",
  "editorial": {
    "html": " <p>Though Will Oldham began his musical career while in his early twenties, he&apos;s never exactly sounded young. From his first releases as Palace Music, Oldham&apos;s whiskey-soaked vocals and lyrical obsessions with death, sex, and religion have made &quot;maturity&quot; something of a non-issue. And yet, with his most recent couple of releases as Bonnie &quot;Prince&quot; Billy, the aesthetic antiquity of his earliest recordings seems to have slowly given way to a more mundane sense of age. On <em>The Letting Go</em>, the humor, dread, and resignation that inform Oldham&apos;s music are presented in blissfully unfiltered form, and whether the proximity one feels is to person or persona is ultimately irrelevant; either way, <em>The Letting Go</em> feels <em>close</em>.</p><p> With its pristine recording and prominent female backing vocals, opener &quot;Love Comes to Me&quot; evokes Oldham&apos;s 2003 album <em>Master and Everyone</em>. Thankfully, the sound of <em>The Letting Go </em>proves to be more inviting and striking than that of its predecessor, as Oldham and Faun Fables vocalist Dawn McCarthy invariably find their way to beautiful moments-- even when the songs themselves aren&apos;t particularly engrossing. A late autumn stroll through the woods might not be the most exciting metaphor for an album, but it&apos;s a rare treat to hear something this organic and cozy<em></em>.</p><p> In fact, <em>The Letting Go</em> is so confident that its strangeness could easily go unnoticed. But this is, in many ways, one of the weirdest records Oldham has ever released. McCarthy&apos;s vocals never really coalesce into a distinct relationship with Oldham&apos;s-- she slips in and out of harmonies, backing parts, doubles, and absences. The album&apos;s arrangements are similarly elusive-- the string swells and ominous drums on &quot;The Seedling&quot; wash incongruously against McCarthy&apos;s vocals. And yet, nothing ever seems jarringly out of place. </p><p> Generally speaking, this is true of the album&apos;s sequencing as well. Though the more lo-fi and bluesy &quot;Cold &amp; Wet&quot; is a noticeable shift from the rest of the record, it&apos;s by no means unwelcome after the perhaps-too-understated &quot;No Bad News&quot;. On the whole, <em>The Letting Go</em> is amazingly consistent, Oldham and McCarthy meandering tunefully through subtle but effective changes in texture and tone. Unlike Oldham&apos;s best work, <em>The Letting Go</em> doesn&apos;t pull you into its own emotional world; it doesn&apos;t ask much, and you&apos;re free to take as much from it as you&apos;d like. The beauty and eccentricity of <em>The Letting Go</em> doesn&apos;t provoke deep absorption or self-reflection so much as a kind of fond familiarity. </p> ",
    "text": " Though Will Oldham began his musical career while in his early twenties, he's never exactly sounded young. From his first releases as Palace Music, Oldham's whiskey-soaked vocals and lyrical obsessions with death, sex, and religion have made \"maturity\" something of a non-issue. And yet, with his most recent couple of releases as Bonnie \"Prince\" Billy, the aesthetic antiquity of his earliest recordings seems to have slowly given way to a more mundane sense of age. On The Letting Go, the humor, dread, and resignation that inform Oldham's music are presented in blissfully unfiltered form, and whether the proximity one feels is to person or persona is ultimately irrelevant; either way, The Letting Go feels close. With its pristine recording and prominent female backing vocals, opener \"Love Comes to Me\" evokes Oldham's 2003 album Master and Everyone. Thankfully, the sound of The Letting Go proves to be more inviting and striking than that of its predecessor, as Oldham and Faun Fables vocalist Dawn McCarthy invariably find their way to beautiful moments-- even when the songs themselves aren't particularly engrossing. A late autumn stroll through the woods might not be the most exciting metaphor for an album, but it's a rare treat to hear something this organic and cozy. In fact, The Letting Go is so confident that its strangeness could easily go unnoticed. But this is, in many ways, one of the weirdest records Oldham has ever released. McCarthy's vocals never really coalesce into a distinct relationship with Oldham's-- she slips in and out of harmonies, backing parts, doubles, and absences. The album's arrangements are similarly elusive-- the string swells and ominous drums on \"The Seedling\" wash incongruously against McCarthy's vocals. And yet, nothing ever seems jarringly out of place.  Generally speaking, this is true of the album's sequencing as well. Though the more lo-fi and bluesy \"Cold & Wet\" is a noticeable shift from the rest of the record, it's by no means unwelcome after the perhaps-too-understated \"No Bad News\". On the whole, The Letting Go is amazingly consistent, Oldham and McCarthy meandering tunefully through subtle but effective changes in texture and tone. Unlike Oldham's best work, The Letting Go doesn't pull you into its own emotional world; it doesn't ask much, and you're free to take as much from it as you'd like. The beauty and eccentricity of The Letting Go doesn't provoke deep absorption or self-reflection so much as a kind of fond familiarity.  "
  }
}
```

``.truncated``

The attributes of the {Review} instance with editorial.html/editorial.text condensed into the first 300 characters of of the text assigned to the key '.text'.

```json
{
  "url": "/reviews/albums/9419-the-letting-go/",
  "name": "Bonnie \"Prince\" Billy - The Letting Go",
  "artist": "Bonnie \"Prince\" Billy",
  "album": "The Letting Go",
  "title": "Bonnie \"Prince\" Billy: The Letting Go | Album Reviews | Pitchfork",
  "label": "Palace / Drag City",
  "year": "2006",
  "score": 8.2,
  "cover": "http://cdn.pitchfork.com/albums/9255/homepage_large.e8a2bd20.jpg",
  "author": "Mark Richardson",
  "date": "September 18, 2006",
  "text": " Though Will Oldham began his musical career while in his early twenties, he's never exactly sounded young. From his first releases as Palace Music, Oldham's whiskey-soaked vocals and lyrical obsessions with death, sex, and religion have made \"maturity\" something of a non-issue. And yet, with his mo..."
}
```

``.text_pretty_print``

Prints a plain-text representation of the review.


## CLI (Command-Line Interface)

Returns a review for a given artist and album title.

```bash
$ pitchfork -a 'wilco' -t 'yankee hotel foxtrot'
# { ... pretty-printed, colorized quasi-JSON object... }
```

Returns a list of reviews for a given artist with no album.

```bash
$ pitchfork -a 'wilco'
# [ 
#    { ... pretty-printed, colorized quasi-JSON object... },
#    { ... pretty-printed, colorized quasi-JSON object... },
#    { ... pretty-printed, colorized quasi-JSON object... }
# ]
```

For valid, uncolored JSON, use the --json flag:

```bash
$ pitchfork -a 'wilco' -t 'yankee hotel foxtrot' --json
# { ... valid JSON object... }
```

### Flags

| flag(s)      |  required | argument    | description  |
| -------      | ---- | ---------   | ------------ |
| -a           |  y  | artist_name |  returns a review by given artist           |
| -t           |    | album_title |  returns a review by given album title |
| -j,--json     |   |    |  returns review attributes as un-prettified json |
| -v, --verbose  |  |    |  returns review entire object as json |
| -V, --version   |  |    | returns version number |
| -T,--truncated |  |    |  returns a truncated json object of the review attributes | 
| -tx,--text      |  |    | returns a text version of review (ex: to pipe output to 'less' ) |

